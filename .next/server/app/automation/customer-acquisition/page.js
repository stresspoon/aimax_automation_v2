(()=>{var a={};a.id=5187,a.ids=[5187],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4513:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>C.a,__next_app__:()=>I,handler:()=>K,pages:()=>H,routeModule:()=>J,tree:()=>G});var d=c(65239),e=c(48088),f=c(47220),g=c(81289),h=c(26191),i=c(14823),j=c(71998),k=c(92603),l=c(54649),m=c(32781),n=c(82602),o=c(61268),p=c(4853),q=c(261),r=c(5052),s=c(9977),t=c(26713),u=c(43365),v=c(71454),w=c(67778),x=c(46143),y=c(39105),z=c(38171),A=c(86439),B=c(16133),C=c.n(B),D=c(30893),E=c(52836),F={};for(let a in D)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(F[a]=()=>D[a]);c.d(b,F);let G={children:["",{children:["automation",{children:["customer-acquisition",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,37489)),"/Users/designers/Projects/aimax-automation-v2/src/app/automation/customer-acquisition/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,94431)),"/Users/designers/Projects/aimax-automation-v2/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,16133,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,80849,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,29868,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,79615,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,H=["/Users/designers/Projects/aimax-automation-v2/src/app/automation/customer-acquisition/page.tsx"],I={require:c,loadChunk:()=>Promise.resolve()},J=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/automation/customer-acquisition/page",pathname:"/automation/customer-acquisition",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:G},distDir:".next",projectDir:""});async function K(a,b,c){var d;let B="/automation/customer-acquisition/page";"/index"===B&&(B="/");let F="false",L=(0,h.getRequestMeta)(a,"postponed"),M=(0,h.getRequestMeta)(a,"minimalMode"),N=await J.prepare(a,b,{srcPage:B,multiZoneDraftMode:F});if(!N)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:O,query:P,params:Q,parsedUrl:R,pageIsDynamic:S,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,serverActionsManifest:W,clientReferenceManifest:X,subresourceIntegrityManifest:Y,prerenderManifest:Z,isDraftMode:$,resolvedPathname:_,revalidateOnlyGenerated:aa,routerServerContext:ab,nextConfig:ac}=N,ad=R.pathname||"/",ae=(0,q.normalizeAppPath)(B),{isOnDemandRevalidate:af}=N,ag=Z.dynamicRoutes[ae],ah=Z.routes[_],ai=!!(ag||ah||Z.routes[ae]),aj=a.headers["user-agent"]||"",ak=(0,t.getBotType)(aj),al=(0,o.isHtmlBotRequest)(a),am=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??!!a.headers[s.NEXT_ROUTER_PREFETCH_HEADER],an=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[s.RSC_HEADER],ao=(0,r.getIsPossibleServerAction)(a),ap=(0,l.checkIsAppPPREnabled)(ac.experimental.ppr)&&(null==(d=Z.routes[ae]??Z.dynamicRoutes[ae])?void 0:d.renderingMode)==="PARTIALLY_STATIC",aq=!1,ar=!1,as=ap?L:void 0,at=ap&&an&&!am,au=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),av=!aj||(0,o.shouldServeStreamingMetadata)(aj,ac.htmlLimitedBots);al&&ap&&(ai=!1,av=!1);let aw=!0===J.isDev||!ai||"string"==typeof L||at,ax=al&&ap,ay=null;$||!ai||aw||ao||as||at||(ay=_);let az=ay;!az&&J.isDev&&(az=_);let aA={...D,tree:G,pages:H,GlobalError:C(),handler:K,routeModule:J,__next_app__:I};W&&X&&(0,n.setReferenceManifestsSingleton)({page:B,clientReferenceManifest:X,serverActionsManifest:W,serverModuleMap:(0,p.createServerModuleMap)({serverActionsManifest:W})});let aB=a.method||"GET",aC=(0,g.getTracer)(),aD=aC.getActiveScopeSpan();try{let d=async(c,d)=>{let e=new k.NodeNextRequest(a),f=new k.NodeNextResponse(b);return J.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aC.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aB} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aB} ${a.url}`)})},f=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:P,params:Q,page:ae,sharedContext:{buildId:O},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aA,Component:(0,j.T)(aA),params:Q,routeModule:J,page:B,postponed:f,shouldWaitOnAllReady:ax,serveStreamingMetadata:av,supportsDynamicResponse:"string"==typeof f||aw,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,subresourceIntegrityManifest:Y,serverActionsManifest:W,clientReferenceManifest:X,setIsrStatus:null==ab?void 0:ab.setIsrStatus,dir:J.projectDir,isDraftMode:$,isRevalidate:ai&&!f&&!at,botType:ak,isOnDemandRevalidate:af,isPossibleServerAction:ao,assetPrefix:ac.assetPrefix,nextConfigOutput:ac.output,crossOrigin:ac.crossOrigin,trailingSlash:ac.trailingSlash,previewProps:Z.preview,deploymentId:ac.deploymentId,enableTainting:ac.experimental.taint,htmlLimitedBots:ac.htmlLimitedBots,devtoolSegmentExplorer:ac.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ac.reactMaxHeadersLength,multiZoneDraftMode:F,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ac.experimental.cacheLife,basePath:ac.basePath,serverActions:ac.experimental.serverActions,...aq?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:aq}:{},experimental:{isRoutePPREnabled:ap,expireTime:ac.expireTime,staleTimes:ac.experimental.staleTimes,dynamicIO:!!ac.experimental.dynamicIO,clientSegmentCache:!!ac.experimental.clientSegmentCache,dynamicOnHover:!!ac.experimental.dynamicOnHover,inlineCss:!!ac.experimental.inlineCss,authInterrupts:!!ac.experimental.authInterrupts,clientTraceMetadata:ac.experimental.clientTraceMetadata||[]},waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>J.onRequestError(a,b,d,ab),err:(0,h.getRequestMeta)(a,"invokeError"),dev:J.isDev}},k=await d(e,i),{metadata:l}=k,{cacheControl:m,headers:n={},fetchTags:o}=l;if(o&&(n[x.NEXT_CACHE_TAGS_HEADER]=o),a.fetchMetrics=l.fetchMetrics,ai&&(null==m?void 0:m.revalidate)===0&&!J.isDev&&!ap){let a=l.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${_}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:u.CachedRouteKind.APP_PAGE,html:k,headers:n,rscData:l.flightData,postponed:l.postponed,status:l.statusCode,segmentData:l.segmentData},cacheControl:m}},l=async({hasResolved:d,previousCacheEntry:g,isRevalidating:i,span:j})=>{let k,l=!1===J.isDev,n=d||b.writableEnded;if(af&&aa&&!g&&!M)return(null==ab?void 0:ab.render404)?await ab.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ag&&(k=(0,v.parseFallbackField)(ag.fallback)),k===v.FallbackMode.PRERENDER&&(0,t.isBot)(aj)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),(null==g?void 0:g.isStale)===-1&&(af=!0),af&&(k!==v.FallbackMode.NOT_FOUND||g)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),!M&&k!==v.FallbackMode.BLOCKING_STATIC_RENDER&&az&&!n&&!$&&S&&(l||!ah)){let b;if((l||ag)&&k===v.FallbackMode.NOT_FOUND)throw new A.NoFallbackError;if(ap&&!an){if(b=await J.handleResponse({cacheKey:l?ae:null,req:a,nextConfig:ac,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:Z,isRoutePPREnabled:ap,responseGenerator:async()=>f({span:j,postponed:void 0,fallbackRouteParams:l||ar?(0,m.u)(ae):null}),waitUntil:c.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=af||i||!as?void 0:as;if(aq&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:u.CachedRouteKind.PAGES,html:w.default.fromStatic(""),pageData:{},headers:void 0,status:void 0}};let p=S&&ap&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ar)?(0,m.u)(ad):null;return f({span:j,postponed:o,fallbackRouteParams:p})},n=async d=>{var g,i,j,k,m;let n,o=await J.handleResponse({cacheKey:ay,responseGenerator:a=>l({span:d,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:af,isRoutePPREnabled:ap,req:a,nextConfig:ac,prerenderManifest:Z,waitUntil:c.waitUntil});if($&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),J.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!o){if(ay)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(g=o.value)?void 0:g.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(j=o.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof o.value.postponed;ai&&!at&&(!p||am)&&(M||b.setHeader("x-nextjs-cache",af?"REVALIDATED":o.isMiss?"MISS":o.isStale?"STALE":"HIT"),b.setHeader(s.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=o;if(as)n={revalidate:0,expire:void 0};else if(M&&an&&!am&&ap)n={revalidate:0,expire:void 0};else if(!J.isDev)if($)n={revalidate:0,expire:void 0};else if(ai){if(o.cacheControl)if("number"==typeof o.cacheControl.revalidate){if(o.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${o.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});n={revalidate:o.cacheControl.revalidate,expire:(null==(k=o.cacheControl)?void 0:k.expire)??ac.expireTime}}else n={revalidate:x.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(n={revalidate:0,expire:void 0});if(o.cacheControl=n,"string"==typeof au&&(null==q?void 0:q.kind)===u.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(m=q.headers)?void 0:m[x.NEXT_CACHE_TAGS_HEADER];M&&ai&&c&&"string"==typeof c&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(au);return void 0!==d?(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(d),cacheControl:o.cacheControl}):(b.statusCode=204,(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(""),cacheControl:o.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...o,value:{...o.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&as)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(M&&ai||delete a[x.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(i=q.headers)?void 0:i[x.NEXT_CACHE_TAGS_HEADER];if(M&&ai&&t&&"string"==typeof t&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,t),!q.status||an&&ap||(b.statusCode=q.status),!M&&q.status&&E.RedirectStatusCode[q.status]&&an&&(b.statusCode=200),p&&b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"1"),an&&!$){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:q.html,cacheControl:at?{revalidate:0,expire:void 0}:o.cacheControl})}return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(q.rscData),cacheControl:o.cacheControl})}let v=q.html;if(!p||M)return(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:o.cacheControl});if(aq)return v.chain(new ReadableStream({start(a){a.enqueue(y.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let A=new TransformStream;return v.chain(A.readable),f({span:d,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(A.writable)}).catch(a=>{A.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aD)return await aC.withPropagatedContext(a.headers,()=>aC.trace(i.BaseServerSpan.handleRequest,{spanName:`${aB} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aB,"http.target":a.url}},n));await n(aD)}catch(b){throw aD||b instanceof A.NoFallbackError||await J.onRequestError(a,b,{routerKind:"App Router",routePath:B,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ai,isOnDemandRevalidate:af})},ab),b}}},5943:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>i});var d=c(60687),e=c(43210),f=c(68631),g=c(85814),h=c.n(g);function i(){let[a,b]=(0,e.useState)(null),[c,g]=(0,e.useState)(null),[i,j]=(0,e.useState)(!1),[k,l]=(0,e.useState)(!1),[m,n]=(0,e.useState)("selected"),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(""),[s,t]=(0,e.useState)(!1),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)(null),[A,B]=(0,e.useState)(""),[C,D]=(0,e.useState)(!1),[E,F]=(0,e.useState)(!0),[G,H]=(0,e.useState)(0),[I,J]=(0,e.useState)(""),[K,L]=(0,e.useState)(!1),[M,N]=(0,e.useState)(""),[O,P]=(0,e.useState)({step1:{keyword:"",contentType:"blog",apiKey:"",instructions:"",generateImages:!1,generatedContent:"",generatedImages:[]},step2:{sheetUrl:"",isRunning:!1,candidates:[],selectionCriteria:{threads:500,blog:300,instagram:1e3}},step3:{targetType:"selected",emailSubject:"",emailBody:"",senderEmail:"",emailsSent:0}}),[Q,R]=(0,e.useState)(!1),[S,T]=(0,e.useState)(null),[U,V]=(0,e.useState)(!1),[W,X]=(0,e.useState)(!1),Y={blog:`블로그 고객모집 글 작성 가이드:

1. 제목 작성법
   • 검색 키워드를 자연스럽게 포함
   • 숫자나 질문형식 활용 (예: "2024년 최신 ~5가지 방법")
   • 호기심을 유발하는 제목 구성

2. 도입부 (첫 문단)
   • 독자의 공감대 형성
   • 문제 상황 제시
   • 해결책 암시

3. 본문 구성
   • 소제목으로 가독성 향상
   • 구체적인 사례와 데이터 제시
   • 이미지를 활용한 시각적 설명
   • 전문성 있는 정보 제공

4. CTA (행동 유도)
   • 자연스러운 제품/서비스 소개
   • 구체적인 혜택 제시
   • 연락처나 링크 명확히 표기

5. SEO 최적화
   • 키워드 3-5회 자연스럽게 배치
   • 관련 키워드 활용
   • 메타 설명 최적화`,thread:`스레드 고객모집 글 작성 가이드:

1. 첫 트윗 (Hook)
   • 강력한 한 줄로 시작
   • 숫자, 이모지 활용
   • 질문이나 충격적 사실 제시

2. 스토리텔링
   • 개인 경험담 활용
   • 짧고 임팩트 있는 문장
   • 각 트윗당 280자 이내
   • 연결성 있는 내용 구성

3. 가치 전달
   • 구체적인 팁 제공
   • 실행 가능한 조언
   • 빠른 결과를 약속

4. 시각적 요소
   • 번호 매기기 (1/, 2/, 3/...)
   • 줄바꿈으로 가독성 향상
   • 핵심 단어 강조

5. 마무리
   • 명확한 CTA
   • 리트윗 유도
   • 팔로우 요청
   • DM이나 링크 안내`},Z=a=>{P({...O,step1:{...O.step1,contentType:a,instructions:Y[a]}})},$=async()=>{if(!U&&null!==S&&S<=0)return void al("무료 체험 횟수를 모두 사용했습니다. 유료 플랜으로 업그레이드해주세요.","error");if(!O.step1.keyword||!O.step1.instructions)return void al("키워드와 지침을 입력해주세요","error");R(!0);try{let a=await fetch("/api/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:O.step1.apiKey||void 0,keyword:O.step1.keyword,contentType:O.step1.contentType,instructions:O.step1.instructions,generateImages:O.step1.generateImages})}),b=await a.json();if(!a.ok){b.needsUpgrade?al("무료 체험 횟수를 모두 사용했습니다. 유료 플랜으로 업그레이드해주세요.","error"):al(b.error||"생성 실패","error"),R(!1);return}b.usage&&(-1===b.usage.limit?(V(!0),T(null)):(V(!1),T(b.usage.remaining))),P({...O,step1:{...O.step1,generatedContent:b.content,generatedImages:b.images||[]}}),al("생성이 완료되었습니다","success")}catch(a){al(a?.message||"에러가 발생했습니다","error")}finally{R(!1)}},_=async()=>{try{await navigator.clipboard.writeText(O.step1.generatedContent||""),al("생성된 콘텐츠가 클립보드에 복사되었습니다","success")}catch{al("복사에 실패했습니다","error")}},aa=async()=>{try{let a=await fetch("/api/auth/gmail",{method:"GET"}),b=await a.json();if(!a.ok)return void al(b.error||"Gmail 연결 실패","error");b.url&&(window.location.href=b.url)}catch(a){console.error("Gmail connection error:",a),al("Gmail 연결 중 오류가 발생했습니다","error")}},ab=async()=>{try{let a=await fetch("/api/auth/gmail",{method:"DELETE"});if(a.ok)B(""),al("Gmail 연결이 해제되었습니다","info");else{let b=await a.json();al(b.error||"Gmail 연결 해제 실패","error")}}catch(a){console.error("Gmail disconnection error:",a),al("Gmail 연결 해제 중 오류가 발생했습니다","error")}},ac=async()=>{if(!O.step2.sheetUrl)return void al("구글시트 URL을 입력해주세요","error");if(O.step2.isRunning)P({...O,step2:{...O.step2,isRunning:!1}}),al("자동화가 일시정지되었습니다","info"),aj();else{R(!0),ag({total:100,current:0,currentName:"구글 시트 연결 준비 중...",status:"loading",phase:"sheet_loading"});try{let a=await fetch("/api/sheets/prepare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetUrl:O.step2.sheetUrl})}),b=await a.json();if(!a.ok||!Array.isArray(b.candidates)||0===b.candidates.length){al(b.error||"시트에서 후보를 찾을 수 없습니다","error"),R(!1);return}P(a=>({...a,step2:{...a.step2,isRunning:!0,candidates:b.candidates}})),ag(a=>({...a,total:3*b.candidates.length,current:0,currentName:`후보 ${b.candidates.length}명 로드됨`,status:"processing",phase:"sns_checking"}));let c=b.candidates.length;for(let a=0;a<c;a++){let d=b.candidates[a];P(b=>{let c={...b},e=c.step2.candidates[a];return c.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,threads:d.threadsUrl?"checking":"no_url"}},c}),ag(b=>({...b,currentName:`(${a+1}/${c}) Threads 측정 중...`,currentSns:"threads",current:3*a+0}));let e={threads:0};if(d.threadsUrl)try{let b=await fetch("/api/sheets/measure",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidate:d,channel:"threads"})});e=await b.json(),P(b=>{let c={...b},d=c.step2.candidates[a];return c.step2.candidates[a]={...d,threads:e.threads||0,checkStatus:{...d.checkStatus,threads:"completed"}},c})}catch(b){P(c=>{let d={...c},e=d.step2.candidates[a];return d.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,threads:"error",threadsError:b?.message||"threads 오류"}},d})}ag(b=>({...b,current:3*a+1})),P(b=>{let c={...b},e=c.step2.candidates[a];return c.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,blog:d.blogUrl?"checking":"no_url"}},c}),ag(b=>({...b,currentName:`(${a+1}/${c}) 블로그 측정 중...`,currentSns:"blog",current:3*a+1}));let f={blog:0};if(d.blogUrl)try{let b=await fetch("/api/sheets/measure",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidate:d,channel:"blog"})});f=await b.json(),P(b=>{let c={...b},d=c.step2.candidates[a];return c.step2.candidates[a]={...d,blog:f.blog||0,checkStatus:{...d.checkStatus,blog:"completed"}},c})}catch(b){P(c=>{let d={...c},e=d.step2.candidates[a];return d.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,blog:"error",blogError:b?.message||"blog 오류"}},d})}ag(b=>({...b,current:3*a+2})),P(b=>{let c={...b},e=c.step2.candidates[a];return c.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,instagram:d.instagramUrl?"checking":"no_url"}},c}),ag(b=>({...b,currentName:`(${a+1}/${c}) 인스타그램 측정 중...`,currentSns:"instagram",current:3*a+2}));let g={instagram:0};if(d.instagramUrl)try{let b=await fetch("/api/sheets/measure",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidate:d,channel:"instagram"})});g=await b.json(),P(b=>{let c={...b},d=c.step2.candidates[a],h=(e.threads||0)>=c.step2.selectionCriteria.threads||(f.blog||0)>=c.step2.selectionCriteria.blog||(g.instagram||0)>=c.step2.selectionCriteria.instagram;return c.step2.candidates[a]={...d,instagram:g.instagram||0,status:h?"selected":"notSelected",checkStatus:{...d.checkStatus,instagram:"completed"}},c})}catch(b){P(c=>{let d={...c},e=d.step2.candidates[a];return d.step2.candidates[a]={...e,checkStatus:{...e.checkStatus,instagram:"error",instagramError:b?.message||"instagram 오류"}},d})}else P(b=>{let c={...b},d=c.step2.candidates[a],g=(e.threads||0)>=c.step2.selectionCriteria.threads||(f.blog||0)>=c.step2.selectionCriteria.blog;return c.step2.candidates[a]={...d,status:g?"selected":"notSelected"},c});ag(b=>({...b,current:3*a+3}))}ag(a=>({...a,currentName:"완료",status:"completed",phase:"completed",current:3*c,currentSns:void 0})),al("후보별 SNS 체크가 완료되었습니다","success")}catch(a){console.error(a),al("시트 준비 또는 측정 중 오류가 발생했습니다","error")}finally{R(!1)}}},[ad,ae]=(0,e.useState)(null),[af,ag]=(0,e.useState)({total:0,current:0,currentName:"",status:"completed",phase:"completed"}),[ah,ai]=(0,e.useState)(null),aj=()=>{ad&&(clearInterval(ad),ae(null)),ak()},ak=()=>{ah&&(clearInterval(ah),ai(null)),ag({total:0,current:0,currentName:"",status:"completed",phase:"completed"})},al=(a,b)=>{g({message:a,type:b}),setTimeout(()=>g(null),3e3)},am=async()=>{if(!O.step3.emailSubject||!O.step3.emailBody)return void al("제목과 본문을 입력해주세요","error");if(!A&&!O.step3.senderEmail)return void al("Gmail을 연결하거나 발신 이메일을 입력해주세요","error");if(0===O.step2.candidates.length)return void al("발송할 대상이 없습니다. Step 2에서 데이터를 가져와주세요","error");R(!0);try{let a=O.step2.candidates.filter(a=>"selected"===O.step3.targetType?"selected"===a.status:"notSelected"!==O.step3.targetType||"notSelected"===a.status),b=await fetch(A?"/api/emails/send-gmail":"/api/emails/send-batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipients:a,subject:O.step3.emailSubject,body:O.step3.emailBody,replyTo:O.step3.senderEmail,candidates:a,targetType:O.step3.targetType,projectId:w})}),c=await b.json();if(!b.ok)return void al(c.error||"이메일 발송 실패","error");let d=0;void 0!==c.sent&&void 0!==c.failed?(d=c.sent,c.sent>0&&0===c.failed?al(`${c.sent}명에게 이메일이 성공적으로 발송되었습니다!`,"success"):c.sent>0&&c.failed>0?al(`${c.sent}명 발송 성공, ${c.failed}명 발송 실패`,"info"):al("이메일 발송에 실패했습니다","error")):(d=a.length,al(c.message||"이메일이 성공적으로 발송되었습니다!","success")),d>0&&P(a=>({...a,step3:{...a.step3,emailsSent:(a.step3.emailsSent||0)+d}}))}catch(a){al("이메일 발송 중 오류가 발생했습니다","error")}finally{R(!1)}};return(0,d.jsxs)("div",{className:"min-h-screen bg-background",children:[k&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"이메일 자동 작성"}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"이메일 타입"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{onClick:()=>n("selected"),className:`flex-1 py-2 px-3 rounded border ${"selected"===m?"border-primary bg-primary/10 text-primary font-semibold":"border-gray-300"}`,children:"선정 안내"}),(0,d.jsx)("button",{onClick:()=>n("notSelected"),className:`flex-1 py-2 px-3 rounded border ${"notSelected"===m?"border-primary bg-primary/10 text-primary font-semibold":"border-gray-300"}`,children:"미선정 안내"}),(0,d.jsx)("button",{onClick:()=>n("custom"),className:`flex-1 py-2 px-3 rounded border ${"custom"===m?"border-primary bg-primary/10 text-primary font-semibold":"border-gray-300"}`,children:"사용자 정의"})]})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"제품/서비스 정보 (선택)"}),(0,d.jsx)("textarea",{value:q,onChange:a=>r(a.target.value),placeholder:"예: 친환경 화장품 브랜드, 민감성 피부용 스킨케어 라인...",rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-primary"})]}),"custom"===m&&(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"작성 지침 *"}),(0,d.jsx)("textarea",{value:o,onChange:a=>p(a.target.value),placeholder:"이메일 작성 지침을 입력하세요...",rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-primary"})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Gemini API Key"}),(0,d.jsx)("input",{type:"password",value:O.step1.apiKey,onChange:a=>P({...O,step1:{...O.step1,apiKey:a.target.value}}),placeholder:"AI... (Step 1에서 사용한 키)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-primary"})]}),(0,d.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"대상자 예시:"}),(0,d.jsxs)("div",{className:"text-xs space-y-1",children:[(0,d.jsx)("p",{children:"• 이름: 김철수"}),(0,d.jsxs)("p",{children:["• 상태: ","selected"===m?"선정":"notSelected"===m?"미선정":"사용자 정의"]}),(0,d.jsx)("p",{children:"• Threads: 800 팔로워"})]})]}),(0,d.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,d.jsx)("button",{onClick:()=>{l(!1),p(""),r("")},className:"px-4 py-2 rounded border",children:"취소"}),(0,d.jsx)("button",{onClick:async()=>{if(!O.step1.apiKey)return void al("API 키를 입력해주세요","error");if("custom"===m&&!o)return void al("작성 지침을 입력해주세요","error");t(!0);try{let a=O.step2.candidates.find(a=>"selected"===m?"selected"===a.status:"notSelected"!==m||"notSelected"===a.status)||{name:"김철수",email:"example@email.com",threads:800,blog:400,instagram:1200,status:"selected"===m?"selected":"notSelected"},b=await fetch("/api/ai/compose-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:O.step1.apiKey,candidateInfo:a,emailType:m,customInstructions:o,productInfo:q})}),c=await b.json();if(!b.ok)throw Error(c.error||"생성 실패");P({...O,step3:{...O.step3,emailSubject:c.subject,emailBody:c.body}}),al("이메일이 자동 작성되었습니다","success"),l(!1),p(""),r("")}catch(a){al(a.message,"error")}finally{t(!1)}},disabled:s||!O.step1.apiKey||"custom"===m&&!o,className:"px-4 py-2 rounded bg-primary text-white disabled:opacity-50",children:s?"생성 중...":"이메일 생성"})]})]})}),i&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"지침 수정 가이드"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"가이드는 예시일 뿐입니다. 브랜드 톤과 타깃에 맞게 키워드, 문체, CTA를 조정하세요. 과도한 형용사보다 구체적인 이점과 실행 요소를 강조하면 전환율이 올라갑니다."}),(0,d.jsxs)("ul",{className:"text-sm list-disc pl-5 space-y-1 mb-4 text-muted-foreground",children:[(0,d.jsx)("li",{children:"키워드는 제목/서론/결론에 분산 배치"}),(0,d.jsx)("li",{children:"소제목은 문제-해결-증거-CTA 흐름"}),(0,d.jsx)("li",{children:"스레드는 각 항목 1~2문장, 실행 팁 포함"})]}),(0,d.jsx)("div",{className:"flex justify-end gap-2",children:(0,d.jsx)("button",{onClick:()=>j(!1),className:"px-3 py-2 rounded border",children:"닫기"})})]})}),c&&(0,d.jsx)("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-top-2 fade-in duration-300",children:(0,d.jsx)("div",{className:`px-6 py-3 rounded-lg shadow-lg font-semibold ${"success"===c.type?"bg-green-500 text-white":"error"===c.type?"bg-red-500 text-white":"bg-blue-500 text-white"}`,children:c.message})}),(0,d.jsx)("header",{className:"bg-card border-b",children:(0,d.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(h(),{href:"/dashboard",className:"text-2xl font-bold text-primary",children:"AIMAX"}),(0,d.jsxs)("span",{className:"ml-4 text-muted-foreground",children:["/ 고객모집 자동화 ",M&&`- ${M}`]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsx)(h(),{href:"/automation/customer-acquisition/dashboard",className:"bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg font-semibold transition",children:"대시보드 보기"}),w&&(0,d.jsx)("button",{onClick:()=>X(!0),className:"text-red-600 hover:text-red-700 border border-red-200 px-3 py-2 rounded",children:"프로젝트 삭제"}),(0,d.jsx)(h(),{href:"/dashboard",className:"text-muted-foreground hover:text-foreground",children:"메인으로"})]})]})})}),(0,d.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"고객모집 자동화"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"원하는 단계를 선택하여 시작하세요"})]}),(0,d.jsx)("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[{step:1,title:"고객모집 글쓰기",description:"AI가 자동으로 고객모집용 콘텐츠를 생성합니다"},{step:2,title:"DB 관리",description:"구글폼으로 수집된 고객 데이터를 자동 관리합니다"},{step:3,title:"이메일 발송",description:"선정된 고객에게 자동으로 이메일을 발송합니다"}].map(({step:c,title:e,description:g})=>(0,d.jsxs)(f.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*c},onClick:()=>b(a===c?null:c),className:`bg-card border-2 rounded-xl p-6 cursor-pointer transition-all hover:shadow-lg ${a===c?"border-primary shadow-lg":"border-border hover:border-primary/50"}`,children:[(0,d.jsx)("div",{className:"w-12 h-12 mb-4 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-xl font-bold text-primary",children:c})}),(0,d.jsxs)("h3",{className:"text-xl font-bold text-foreground mb-2",children:["Step ",c,": ",e]}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm mb-4",children:g}),(0,d.jsx)("button",{className:`w-full py-2 rounded-lg font-semibold transition ${a===c?"bg-primary text-primary-foreground":"bg-primary/10 text-primary hover:bg-primary/20"}`,children:a===c?"닫기":"시작하기"})]},c))}),1===a&&(0,d.jsxs)(f.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card border rounded-xl p-8",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Step 1: 고객모집 글쓰기"}),!U&&null!==S&&(0,d.jsx)("div",{className:"text-sm",children:S>0?(0,d.jsxs)("span",{className:"text-muted-foreground",children:["무료 생성 가능: ",(0,d.jsxs)("span",{className:"font-semibold text-primary",children:[S,"회"]})," 남음"]}):(0,d.jsx)("span",{className:"text-destructive font-semibold",children:"무료 생성 횟수 소진 (업그레이드 필요)"})}),U&&(0,d.jsx)("span",{className:"text-sm text-primary font-semibold",children:"프리미엄 사용자 (무제한)"})]}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"콘텐츠 타입"}),(0,d.jsxs)("div",{className:"flex space-x-4",children:[(0,d.jsx)("button",{onClick:()=>Z("blog"),className:`flex-1 py-3 px-4 rounded-lg border-2 transition ${"blog"===O.step1.contentType?"border-primary bg-primary/10 text-primary font-semibold":"border-border text-muted-foreground hover:border-primary/50"}`,children:"블로그 (긴 글)"}),(0,d.jsx)("button",{onClick:()=>Z("thread"),className:`flex-1 py-3 px-4 rounded-lg border-2 transition ${"thread"===O.step1.contentType?"border-primary bg-primary/10 text-primary font-semibold":"border-border text-muted-foreground hover:border-primary/50"}`,children:"스레드 (짧은 글)"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"키워드"}),(0,d.jsx)("input",{type:"text",value:O.step1.keyword,onChange:a=>P({...O,step1:{...O.step1,keyword:a.target.value}}),placeholder:"예: AI 마케팅 자동화",autoComplete:"off",name:"aimax-keyword",className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Gemini API 키",(0,d.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(선택사항 - 이미지 생성용)"})]}),(0,d.jsx)("input",{type:"password",value:O.step1.apiKey,onChange:a=>P({...O,step1:{...O.step1,apiKey:a.target.value}}),placeholder:"AIza...",autoComplete:"new-password",name:"aimax-gemini-api-key",className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20"})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("input",{type:"checkbox",id:"generateImages",checked:O.step1.generateImages,onChange:a=>P({...O,step1:{...O.step1,generateImages:a.target.checked}}),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),(0,d.jsx)("label",{htmlFor:"generateImages",className:"text-sm text-foreground",children:"이미지도 함께 생성하기"})]}),O.step1.contentType&&(0,d.jsxs)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsxs)("label",{className:"block text-sm font-semibold text-foreground",children:["blog"===O.step1.contentType?"블로그":"스레드"," 작성 지침"]}),(0,d.jsx)("button",{onClick:()=>j(!0),className:"text-xs text-primary hover:text-primary/80 font-semibold",children:"지침 수정 가이드"})]}),(0,d.jsx)("textarea",{value:O.step1.instructions,onChange:a=>P({...O,step1:{...O.step1,instructions:a.target.value}}),rows:12,className:"w-full px-4 py-3 rounded-lg border border-primary/20 bg-white focus:outline-none focus:border-primary text-sm"})]}),(0,d.jsx)("button",{onClick:$,disabled:Q||!O.step1.keyword,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground py-3 rounded-lg font-semibold transition disabled:opacity-50",children:Q?"생성 중...":`글 생성하기 (무료 체험 ${S}/3)`}),O.step1.generatedContent&&(0,d.jsxs)("div",{className:"mt-6 p-6 bg-muted/30 rounded-lg border border-border",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h3",{className:"font-bold text-foreground",children:"생성된 콘텐츠"}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsxs)("label",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,d.jsx)("input",{type:"checkbox",checked:E,onChange:a=>F(a.target.checked)}),"타이핑 효과"]}),(0,d.jsx)("button",{onClick:_,className:"text-primary hover:text-primary/80 font-semibold",children:"복사"})]})]}),(0,d.jsx)("pre",{className:"whitespace-pre-wrap text-muted-foreground text-sm",children:E?I:O.step1.generatedContent}),O.step1.generatedImages.length>0&&(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"생성된 이미지:"}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-4",children:O.step1.generatedImages.map((a,b)=>(0,d.jsxs)("div",{className:"relative group",children:[(0,d.jsx)("img",{src:a,alt:`생성된 이미지 ${b+1}`,className:"w-full rounded-lg border border-border"}),(0,d.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,d.jsx)("button",{onClick:async()=>{let c=document.createElement("a");c.href=a,c.download=`image-${b+1}.png`,c.click()},className:"bg-white/90 text-xs px-2 py-1 rounded shadow-sm",children:"다운로드"})})]},b))})]})]}),O.step1.generatedContent&&(0,d.jsx)("button",{onClick:()=>b(2),className:"w-full bg-muted hover:bg-muted/80 text-foreground py-3 rounded-lg font-semibold transition",children:"다음: DB 관리 →"})]})]}),2===a&&(0,d.jsxs)(f.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card border rounded-xl p-8",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Step 2: DB 관리"}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"bg-primary/10 border border-primary/30 rounded-lg p-4",children:[(0,d.jsx)("p",{className:"text-sm text-foreground mb-2",children:"구글폼 + 구글시트 연동 방법"}),(0,d.jsx)(h(),{href:"#",className:"text-primary hover:text-primary/80 font-semibold",children:"노션 매뉴얼 보기 →"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"구글시트 URL"}),(0,d.jsx)("input",{type:"url",value:O.step2.sheetUrl,onChange:a=>P({...O,step2:{...O.step2,sheetUrl:a.target.value}}),placeholder:"https://docs.google.com/spreadsheets/d/...",className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20"})]}),(0,d.jsxs)("div",{className:"bg-muted/30 rounded-lg p-4 border border-border",children:[(0,d.jsx)("h4",{className:"font-semibold text-foreground mb-3",children:"자동 선정 기준 설정"}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm text-muted-foreground",children:"Threads 팔로워"}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("input",{type:"number",value:O.step2.selectionCriteria.threads,onChange:a=>P({...O,step2:{...O.step2,selectionCriteria:{...O.step2.selectionCriteria,threads:parseInt(a.target.value)||0}}}),className:"w-24 px-2 py-1 text-sm rounded border border-border focus:outline-none focus:border-primary"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:"명 이상"})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm text-muted-foreground",children:"네이버 블로그 이웃"}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("input",{type:"number",value:O.step2.selectionCriteria.blog,onChange:a=>P({...O,step2:{...O.step2,selectionCriteria:{...O.step2.selectionCriteria,blog:parseInt(a.target.value)||0}}}),className:"w-24 px-2 py-1 text-sm rounded border border-border focus:outline-none focus:border-primary"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:"명 이상"})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm text-muted-foreground",children:"인스타그램 팔로워"}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("input",{type:"number",value:O.step2.selectionCriteria.instagram,onChange:a=>P({...O,step2:{...O.step2,selectionCriteria:{...O.step2.selectionCriteria,instagram:parseInt(a.target.value)||0}}}),className:"w-24 px-2 py-1 text-sm rounded border border-border focus:outline-none focus:border-primary"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:"명 이상"})]})]})]}),(0,d.jsx)("div",{className:"mt-3 pt-3 border-t border-border",children:(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:'위 기준을 하나라도 충족하면 "선정"으로 자동 분류됩니다'})})]}),(0,d.jsx)("button",{onClick:ac,disabled:!O.step2.sheetUrl,className:`w-full py-3 rounded-lg font-semibold transition disabled:opacity-50 ${O.step2.isRunning?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:O.step2.isRunning?"일시정지":"자동화 시작"}),(O.step2.isRunning||Q||"loading"===af.status||"processing"===af.status)&&(0,d.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,d.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),(0,d.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"sheet_loading"===af.phase?"구글 시트 데이터를 불러오는 중...":"sns_checking"===af.phase?"SNS 팔로워/이웃수를 체크하는 중...":"자동화 실행 중 - 30초마다 새로운 응답을 확인합니다"})]}),("loading"===af.status||"processing"===af.status||af.currentName)&&(0,d.jsxs)("div",{className:"mt-3 space-y-2",children:["sheet_loading"===af.phase&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,d.jsx)("span",{className:"text-gray-600",children:af.currentName||"구글 시트 연결 준비 중..."}),(0,d.jsxs)("span",{className:"text-gray-600",children:[af.current,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${af.current}%`}})})]}),"sns_checking"===af.phase&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm mb-2",children:[(0,d.jsx)("span",{className:"text-gray-600 font-medium",children:af.currentName||"준비 중..."}),(0,d.jsxs)("span",{className:"text-gray-600",children:[Math.floor(af.current/3)+1,"/",Math.floor(af.total/3),"명"]})]}),af.currentSns&&(0,d.jsxs)("div",{className:"space-y-1 mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:`text-xs w-16 ${"threads"===af.currentSns?"font-bold text-blue-700":"text-gray-500"}`,children:"Threads"}),(0,d.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded-full",children:(0,d.jsx)("div",{className:`h-1 rounded-full transition-all duration-300 ${"threads"===af.currentSns?"bg-blue-500 animate-pulse":af.current%3>=1?"bg-green-500":"bg-gray-200"}`,style:{width:"threads"===af.currentSns?"50%":af.current%3>=1?"100%":"0%"}})})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:`text-xs w-16 ${"blog"===af.currentSns?"font-bold text-blue-700":"text-gray-500"}`,children:"블로그"}),(0,d.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded-full",children:(0,d.jsx)("div",{className:`h-1 rounded-full transition-all duration-300 ${"blog"===af.currentSns?"bg-blue-500 animate-pulse":af.current%3>=2?"bg-green-500":"bg-gray-200"}`,style:{width:"blog"===af.currentSns?"50%":af.current%3>=2?"100%":"0%"}})})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:`text-xs w-16 ${"instagram"===af.currentSns?"font-bold text-blue-700":"text-gray-500"}`,children:"인스타"}),(0,d.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded-full",children:(0,d.jsx)("div",{className:`h-1 rounded-full transition-all duration-300 ${"instagram"===af.currentSns?"bg-blue-500 animate-pulse":af.current%3==0&&af.current>0?"bg-green-500":"bg-gray-200"}`,style:{width:"instagram"===af.currentSns?"50%":af.current%3==0&&af.current>0?"100%":"0%"}})})]})]}),(0,d.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${af.current/af.total*100}%`}})}),(0,d.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:["전체 진행률: ",Math.round(af.current/af.total*100),"%"]})]})]})]}),O.step2.candidates.length>0&&(0,d.jsxs)("div",{className:"mt-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("h4",{className:"font-semibold text-text",children:"수집된 후보"}),O.step2.isRunning&&(0,d.jsx)("span",{className:"text-xs text-gray-500",children:"실시간 업데이트 중..."})]}),(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full text-sm",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"border-b border-text/10",children:[(0,d.jsx)("th",{className:"text-left py-2",children:"이름"}),(0,d.jsx)("th",{className:"text-left py-2",children:"이메일"}),(0,d.jsx)("th",{className:"text-center py-2",children:"Threads"}),(0,d.jsx)("th",{className:"text-center py-2",children:"블로그"}),(0,d.jsx)("th",{className:"text-center py-2",children:"인스타"}),(0,d.jsx)("th",{className:"text-center py-2",children:"상태"})]})}),(0,d.jsx)("tbody",{children:O.step2.candidates.map((a,b)=>(0,d.jsxs)("tr",{className:"border-b border-text/5",children:[(0,d.jsx)("td",{className:"py-2",children:a.name}),(0,d.jsx)("td",{className:"py-2",children:a.email}),(0,d.jsx)("td",{className:"text-center py-2",children:a.checkStatus?.threads==="checking"?(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("span",{className:"text-xs text-blue-500",children:"체크중..."}),(0,d.jsx)("div",{className:"w-16 h-1 bg-gray-200 rounded-full mt-1",children:(0,d.jsx)("div",{className:"h-1 bg-blue-500 rounded-full animate-pulse",style:{width:"50%"}})})]}):a.checkStatus?.threads==="error"?(0,d.jsx)("span",{className:"text-xs text-red-500",title:a.checkStatus?.threadsError,children:"오류"}):a.checkStatus?.threads==="no_url"?(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"}):"number"==typeof a.threads?(0,d.jsx)("span",{className:a.threads>=O.step2.selectionCriteria.threads?"text-green-600 font-semibold":"",children:a.threads}):(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"})}),(0,d.jsx)("td",{className:"text-center py-2",children:a.checkStatus?.blog==="checking"?(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("span",{className:"text-xs text-blue-500",children:"체크중..."}),(0,d.jsx)("div",{className:"w-16 h-1 bg-gray-200 rounded-full mt-1",children:(0,d.jsx)("div",{className:"h-1 bg-blue-500 rounded-full animate-pulse",style:{width:"50%"}})})]}):a.checkStatus?.blog==="error"?(0,d.jsx)("span",{className:"text-xs text-red-500",title:a.checkStatus?.blogError,children:"오류"}):a.checkStatus?.blog==="no_url"?(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"}):"number"==typeof a.blog?(0,d.jsx)("span",{className:a.blog>=O.step2.selectionCriteria.blog?"text-green-600 font-semibold":"",children:a.blog}):(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"})}),(0,d.jsx)("td",{className:"text-center py-2",children:a.checkStatus?.instagram==="checking"?(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("span",{className:"text-xs text-blue-500",children:"체크중..."}),(0,d.jsx)("div",{className:"w-16 h-1 bg-gray-200 rounded-full mt-1",children:(0,d.jsx)("div",{className:"h-1 bg-blue-500 rounded-full animate-pulse",style:{width:"50%"}})})]}):a.checkStatus?.instagram==="error"?(0,d.jsx)("span",{className:"text-xs text-red-500",title:a.checkStatus?.instagramError,children:"오류"}):a.checkStatus?.instagram==="no_url"?(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"}):"number"==typeof a.instagram?(0,d.jsx)("span",{className:a.instagram>=O.step2.selectionCriteria.instagram?"text-green-600 font-semibold":"",children:a.instagram}):(0,d.jsx)("span",{className:"text-xs text-gray-400",children:"-"})}),(0,d.jsx)("td",{className:"text-center py-2",children:(0,d.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"selected"===a.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:"selected"===a.status?"선정":"미달"})})]},b))})]})})]}),O.step2.candidates.length>0&&(0,d.jsx)("button",{onClick:()=>b(3),className:"w-full bg-muted hover:bg-muted/80 text-foreground py-3 rounded-lg font-semibold transition",children:"다음: 이메일 발송 →"})]})]}),3===a&&(0,d.jsxs)(f.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card border rounded-xl p-8",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Step 3: 이메일 발송"}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"발송 대상"}),(0,d.jsxs)("div",{className:"flex space-x-4",children:[(0,d.jsx)("button",{onClick:()=>P({...O,step3:{...O.step3,targetType:"selected"}}),className:`flex-1 py-3 px-4 rounded-lg border-2 transition ${"selected"===O.step3.targetType?"border-primary bg-primary/10 text-primary font-semibold":"border-border text-muted-foreground hover:border-primary/50"}`,children:"선정 대상"}),(0,d.jsx)("button",{onClick:()=>P({...O,step3:{...O.step3,targetType:"notSelected"}}),className:`flex-1 py-3 px-4 rounded-lg border-2 transition ${"notSelected"===O.step3.targetType?"border-primary bg-primary/10 text-primary font-semibold":"border-border text-muted-foreground hover:border-primary/50"}`,children:"비선정 대상"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-sm font-medium text-foreground mb-2",children:["발신 이메일 (Gmail)",C?(0,d.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"확인 중..."}):null]}),A?(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("input",{type:"email",value:A,readOnly:!0,className:"w-full px-4 py-3 rounded-lg border border-border bg-muted/30 text-muted-foreground"}),(0,d.jsx)("button",{onClick:ab,className:"px-3 py-2 rounded border text-sm",children:"연결 해제"})]}):(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("input",{type:"email",placeholder:"your@gmail.com",className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20",readOnly:!0}),(0,d.jsx)("button",{onClick:aa,className:"px-3 py-2 rounded bg-primary text-white text-sm",children:"Gmail 연결"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"이메일 제목"}),(0,d.jsx)("input",{type:"text",value:O.step3.emailSubject,onChange:a=>P({...O,step3:{...O.step3,emailSubject:a.target.value}}),placeholder:"예: {이름}님, 특별한 제안이 있습니다",className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-foreground",children:"이메일 본문"}),(0,d.jsx)("button",{onClick:()=>l(!0),className:"text-sm bg-primary hover:bg-primary/90 text-primary-foreground px-3 py-1 rounded font-semibold",children:"Gemini로 자동작성"})]}),(0,d.jsx)("textarea",{value:O.step3.emailBody,onChange:a=>P({...O,step3:{...O.step3,emailBody:a.target.value}}),placeholder:"안녕하세요 {이름}님,  ...",rows:8,className:"w-full px-4 py-3 rounded-lg border border-border focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20"}),(0,d.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground",children:[`{이름}`,", ",`{이메일}`," 등의 변수를 사용할 수 있습니다"]})]}),(0,d.jsx)("button",{onClick:am,disabled:Q||!O.step3.senderEmail||!O.step3.emailSubject||!O.step3.emailBody,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground py-3 rounded-lg font-semibold transition disabled:opacity-50",children:Q?"발송 중...":"이메일 발송"})]})]})]}),W&&w&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"프로젝트 삭제"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"정말로 이 프로젝트를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."}),(0,d.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,d.jsx)("button",{onClick:()=>X(!1),className:"px-3 py-2 rounded border",children:"취소"}),(0,d.jsx)("button",{onClick:async()=>{try{let a=await fetch(`/api/projects/${w}`,{method:"DELETE"}),b=await a.json().catch(()=>({}));if(!a.ok)return void al(b.error||"삭제 실패","error");X(!1),al("프로젝트가 삭제되었습니다","success"),x(null),P({step1:{keyword:"",contentType:"blog",apiKey:"",instructions:"",generateImages:!1,generatedContent:"",generatedImages:[]},step2:{sheetUrl:"",isRunning:!1,candidates:[],selectionCriteria:{threads:500,blog:300,instagram:1e3}},step3:{targetType:"selected",emailSubject:"",emailBody:"",senderEmail:"",emailsSent:0}}),window.location.href="/automation/customer-acquisition/dashboard"}catch(a){al(a?.message||"삭제 중 오류가 발생했습니다","error")}},className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",children:"삭제하기"})]})]})})]})}c(79481)},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:a=>{"use strict";a.exports=require("punycode")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},37489:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/designers/Projects/aimax-automation-v2/src/app/automation/customer-acquisition/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/designers/Projects/aimax-automation-v2/src/app/automation/customer-acquisition/page.tsx","default")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41108:()=>{},46395:(a,b,c)=>{Promise.resolve().then(c.bind(c,5943))},55591:a=>{"use strict";a.exports=require("https")},61135:()=>{},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:a=>{"use strict";a.exports=require("zlib")},78366:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,25227,23)),Promise.resolve().then(c.t.bind(c,86346,23)),Promise.resolve().then(c.t.bind(c,27924,23)),Promise.resolve().then(c.t.bind(c,40099,23)),Promise.resolve().then(c.t.bind(c,38243,23)),Promise.resolve().then(c.t.bind(c,28827,23)),Promise.resolve().then(c.t.bind(c,62763,23)),Promise.resolve().then(c.t.bind(c,97173,23)),Promise.resolve().then(c.bind(c,25587))},79428:a=>{"use strict";a.exports=require("buffer")},79481:(a,b,c)=>{"use strict";c.d(b,{U:()=>e});var d=c(88105);function e(){return(0,d.createBrowserClient)("https://zlowtgtcjdkzdlsclxnq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpsb3d0Z3RjamRremRsc2NseG5xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyNzk0NDEsImV4cCI6MjA3MDg1NTQ0MX0.62w0p10qFuS_1wodeWpl4MVx4CgARSAJgiUI-rUyXls")}},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},81928:(a,b,c)=>{Promise.resolve().then(c.bind(c,37489))},83094:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,16133,23)),Promise.resolve().then(c.t.bind(c,16444,23)),Promise.resolve().then(c.t.bind(c,16042,23)),Promise.resolve().then(c.t.bind(c,49477,23)),Promise.resolve().then(c.t.bind(c,29345,23)),Promise.resolve().then(c.t.bind(c,12089,23)),Promise.resolve().then(c.t.bind(c,46577,23)),Promise.resolve().then(c.t.bind(c,31307,23)),Promise.resolve().then(c.t.bind(c,14817,23))},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},88372:()=>{},94431:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f,metadata:()=>e});var d=c(37413);c(61135);let e={title:"AIMAX - AI 마케팅 자동화 플랫폼",description:"블로그 글쓰기부터 이메일 발송까지, AI로 고객모집을 자동화하세요"};function f({children:a}){return(0,d.jsx)("html",{lang:"ko",suppressHydrationWarning:!0,children:(0,d.jsx)("body",{className:"font-sans antialiased",suppressHydrationWarning:!0,children:a})})}},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4985,1769,5814,8631,8105],()=>b(b.s=4513));module.exports=c})();